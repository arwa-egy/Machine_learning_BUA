data = load_breast_cancer()
X = pd.DataFrame(data.data, columns=data.feature_names)
y = data.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

dt_full = DecisionTreeClassifier(random_state=42)
dt_full.fit(X_train, y_train)

dt_pruned = DecisionTreeClassifier(max_depth=3, random_state=42)
dt_pruned.fit(X_train, y_train)

print("\nDecision Tree (Full Depth)")
print("Train Accuracy:", accuracy_score(y_train, dt_full.predict(X_train)))
print("Test Accuracy :", accuracy_score(y_test, dt_full.predict(X_test)))

print("\nDecision Tree (max_depth=3)")
print("Train Accuracy:", accuracy_score(y_train, dt_pruned.predict(X_train)))
print("Test Accuracy :", accuracy_score(y_test, dt_pruned.predict(X_test)))




rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

rf_train_acc = accuracy_score(y_train, rf.predict(X_train))
rf_test_acc  = accuracy_score(y_test, rf.predict(X_test))

print("\nRandom Forest (100 Trees)")
print("Train Accuracy:", rf_train_acc)
print("Test Accuracy :", rf_test_acc)




print("\nGradient Boosting (Default)")
gb_default = GradientBoostingClassifier(random_state=42)
gb_default.fit(X_train, y_train)

print("Train Accuracy:", accuracy_score(y_train, gb_default.predict(X_train)))
print("Test Accuracy :", accuracy_score(y_test, gb_default.predict(X_test)))

# Experiments
learning_rates = [0.01, 0.1]
estimators_list = [50, 100, 200]

print("\nGradient Boosting")
for lr in learning_rates:
    for n in estimators_list:
        gb = GradientBoostingClassifier(
            learning_rate=lr,
            n_estimators=n,
            random_state=42
        )
        gb.fit(X_train, y_train)
        train_acc = accuracy_score(y_train, gb.predict(X_train))
        test_acc = accuracy_score(y_test, gb.predict(X_test))
        print(f"LR={lr}, Estimators={n}  Train={train_acc:.4f}, Test={test_acc:.4f}")





print("\nRandom Forest")
rf_importance = pd.Series(rf.feature_importances_, index=X.columns)
print(rf_importance.sort_values(ascending=False).head(5))

print("\nGradient Boosting")
gb_importance = pd.Series(gb_default.feature_importances_, index=X.columns)
print(gb_importance.sort_values(ascending=False).head(5))